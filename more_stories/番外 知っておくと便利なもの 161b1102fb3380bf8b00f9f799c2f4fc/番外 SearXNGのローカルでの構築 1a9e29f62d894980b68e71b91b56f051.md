# 番外:SearXNGのローカルでの構築

Difyの公式ドキュメントにやり方が書いてあります。

[SearXNG | English | Dify](https://docs.dify.ai/tutorials/tool-configuration/searxng)

SearXNGは、オープンソースのメタ検索エンジンで、様々な検索サービスやデータベースの結果を集約してくれます。しかも、ユーザーの追跡やプロファイリングは一切行われないので、プライバシー保護の面でも優れているんです。

↑インストール方法は公式ドキュメントにしたがったほうがよい。

ーーーーー以下の方法はもう古いーーーーーー

~~そんなSearXNGを、Difyから直接使えるようにするのが今回のミッション！以下の手順に沿って、SearXNGとDifyを連携させていきましょう。~~

~~【Step 1】Dockerを使ってSearXNGをインストール~~

~~まずは、DockerでSearXNGをインストールします。次のコマンドを実行してください。~~

```
~~docker run --rm \\
             -d -p 8080:8080 \\
             -v "${PWD}/searxng:/etc/searxng" \\
             -e "BASE_URL=http://0.0.0.0:8080/" \\
             -e "INSTANCE_NAME=searxng" \\
             searxng/searxng~~

```

~~（WINDOWSの場合）~~

```python
d~~ocker run --rm ^
       -d -p 8080:8080 ^
       -v "%cd%/searxng:/etc/searxng" ^
       -e "BASE_URL=http://0.0.0.0:8080/" ^
       -e "INSTANCE_NAME=searxng" ^
       searxng/searxng~~

```

~~(PowerShellの場合)~~

```python
~~docker run --rm `
       -d -p 8080:8080 `
       -v "${pwd}/searxng:/etc/searxng" `
       -e "BASE_URL=http://0.0.0.0:8080/" `
       -e "INSTANCE_NAME=searxng" `
       searxng/searxng~~

```

~~これで、SearXNGがDockerコンテナ内で起動します。ポート8080で待ち受けるので、ブラウザから `http://localhost:8080` にアクセスすれば、SearXNGの画面が表示されるはず。~~

~~【Step 2】settings.ymlの変更~~

~~SearXNGのデフォルト出力フォーマットはHTMLなので、JSONフォーマットを有効にする必要があります。~~

~~先ほどのDockerコマンドを実行したディレクトリ内の `searxng/settings.yml` ファイルを開き、以下の行を追加します。~~

```yaml
  formats:
    - html
    - json    # <-- この行を追加

```

~~これで、SearXNGがJSONフォーマットでも出力できるようになりました。~~

~~ためしにローカルで8080ポートにアクセスしてみてください。~~

次のような画面がでれば検索エンジンとして機能するはずです。

![Untitled](%E7%95%AA%E5%A4%96%20SearXNG%E3%81%AE%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A6%E3%82%99%E3%81%AE%E6%A7%8B%E7%AF%89%201a9e29f62d894980b68e71b91b56f051/Untitled.png)

ためしになにか検索してみましょう。

「栃木県鹿沼市の観光スポットは」

と打ちエンターすると次のように結果を表示してくれました。

無事に動いているようです

![Untitled](%E7%95%AA%E5%A4%96%20SearXNG%E3%81%AE%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A6%E3%82%99%E3%81%AE%E6%A7%8B%E7%AF%89%201a9e29f62d894980b68e71b91b56f051/Untitled%201.png)

【Step 3】DifyでSearXNGを連携

Difyの `Tools > SearXNG > To Authorize` ページで、SearXNGのベースURL（ `http://x.x.x.x:8080` ）を入力し、連携を有効化します。

`x.x.x.x` の部分は、SearXNGをインストールしたサーバーのIPアドレスに置き換えてくださいね。

以上で、DifyとSearXNGの連携は完了です！これで、Difyのワークフロー内でSearXNGを使った検索ができるようになります。

SearXNGの強力な検索力を、Difyのワークフローにも活かせるようになったので、より幅広い情報を取り込んだ処理が可能になりますね。

プライバシーに配慮しつつ、多彩な検索結果を統合できるSearXNGは、Difyとの相性も抜群です。